<?php
//This is generated by Swapp Software Application on 18/09/2019 11:51:39 AM for PHP
require_once("../swappbase/formbase.php");
class swapp_table_info extends swappform
{
    Public $owner;
    Public $tablename;
    Public $columid;
    Public $fieldname;
    Public $data_type;
    Public $iscompulsory;
    Public $dependoncolumid;
    Public $entry_para_maxg_cal;
    Public $engdesc;
    Public $unicodedesc;
    Public $iscombo;
    Public $combotable;
    Public $comboengfield;
    Public $combounicodefield;
    Public $combodatafield;
    Public $isprimarykey;
    Public $isadddisplay;
    Public $isreadonly;
    Public $isfinddisplay;
    Public $isqueryinput;
    Public $combotablecondition;
    Public $islistquery;
    Public $combotableowner;
    Public $div;
    Public $sequencenumber;
    public function __construct(&$connection)
    {
     		 parent::__construct($connection);
         $this->owner='';
         $this->tablename='';
         $this->columid='';
         $this->fieldname='';
         $this->data_type='';
         $this->iscompulsory='';
         $this->entry_para_maxg_cal='';
         $this->engdesc='';
         $this->unicodedesc='';
         $this->iscombo='';
         $this->combotable='';
         $this->comboengfield='';
         $this->combounicodefield='';
         $this->combodatafield='';
         $this->isprimarykey='';
         $this->isadddisplay='';
         $this->isreadonly='';
         $this->isfinddisplay='';
         $this->isqueryinput='';
         $this->combotablecondition='';
         $this->islistquery='';
	   }
    public function entryvalidation()
    {
    	$this->start_validation();
        $this->checkrequired($this->columid,'Column Id');
        $this->checkrequired($this->fieldname,'Field Name');
        $this->checkrequired($this->data_type,'Data Type');
        //$this->checkrequired($this->iscompulsory,'Is Compulsory');
        //$this->checkrequired($this->entry_para_maxg_cal,'Input Data');
        $this->checkrequired($this->engdesc,'Name (English)');
        $this->checkrequired($this->unicodedesc,'Name (Unicode)');
        if ($this->iscombo!=0 and $this->iscombo!=3)
        {
            $this->checkrequired($this->combotableowner,'Combo Table Owner');
            $this->checkrequired($this->combotable,'Combo Table');
            $this->checkrequired($this->comboengfield,'Combo English Field');
            $this->checkrequired($this->combounicodefield,'Combo Unicode Field');
            $this->checkrequired($this->combodatafield,'Combo Data Field');
        }
        else
        {
            $this->combotable = '';
            $this->comboengfield = '';
            $this->combounicodefield = '';
            $this->combodatafield = '';
        }
        $this->end_validation();
        return $this->invalidid;
	}
    private function datavalidation()
    {
        $this->start_validation();
    		$this->invalidid=0;
    		$this->invalidmessagetext='Validated';
    		$this->end_validation();
    		return $this->invalidid;
    }
    public function insert()
    {
        $this->dataoperationmode = operationmode::Insert;
	    if ($this->entryvalidation() <> 0)
        {
            return 0;
            exit;
        }
        elseif ($this->datavalidation() <> 0)
        {
            return 0;
            exit;
        }
        $query = "
            insert into nst_nasaka_db.swapp_table_info(
            owner
            ,tablename
            ,columid
            ,dependoncolumid
            ,fieldname
            ,data_type
            ,iscompulsory
            ,entry_para_maxg_cal
            ,engdesc
            ,unicodedesc
            ,iscombo
            ,combotableowner
            ,combotable
            ,comboengfield
            ,combounicodefield
            ,combodatafield
            ,combotablecondition
            ,isprimarykey
            ,isadddisplay
            ,isreadonly
            ,isfinddisplay
            ,isqueryinput
            ,islistquery
            ,div
            ,sequencenumber
	        )
	        values (
            ".$this->invl($this->owner,false)."
            ,".$this->invl($this->tablename,false)."
            ,".$this->invl($this->columid,true)."
            ,".$this->invl($this->dependoncolumid,true,true)."
            ,".$this->invl($this->fieldname,false)."
            ,".$this->invl($this->data_type,false,true)."
            ,".$this->invl($this->iscompulsory,true,true)."
            ,".$this->invl($this->entry_para_maxg_cal,true,true)."
            ,".$this->invl($this->engdesc,false)."
            ,".$this->invl($this->unicodedesc,false)."
            ,".$this->invl($this->iscombo,true,true)."
            ,".$this->invl($this->combotableowner,false)."
            ,".$this->invl($this->combotable,false)."
            ,".$this->invl($this->comboengfield,false)."
            ,".$this->invl($this->combounicodefield,false)."
            ,".$this->invl($this->combodatafield,false)."
            ,".$this->invl($this->combotablecondition,false)."
            ,".$this->invl($this->isprimarykey,true,true)."
            ,".$this->invl($this->isadddisplay,true,true)."
            ,".$this->invl($this->isreadonly,true,true)."
            ,".$this->invl($this->isfinddisplay,true,true)."
            ,".$this->invl($this->isqueryinput,true,true)."
            ,".$this->invl($this->islistquery,true,true)."
            ,".$this->invl($this->div,true,true)."
            ,".$this->invl($this->sequencenumber,true,true)."
            )";
        $result = oci_parse($this->connection, $query);
        if (oci_execute($result,OCI_NO_AUTO_COMMIT))
        {
            return 1;
            exit;
        }
        else
        {
            return 0;
            exit;
        }
    }
    public function display()
	  {
		    $this->dataoperationmode = operationmode::Select;
            $cond='';
            if ($this->owner!='')
		    {
			      if ($cond=='')
			      {
				        $cond="t.owner = '".$this->owner."'";
			       }
			       else
			       {
				        $cond=$cond." and t.owner = '".$this->owner."'";
			       }
            }
            if ($this->tablename!='')
		    {
			      if ($cond=='')
			      {
				        $cond="t.tablename = '".$this->tablename."'";
			       }
			       else
			       {
				        $cond=$cond." and t.tablename = '".$this->tablename."'";
			       }
		    }
            if ($cond!='')
		    {
		        $query = "select t.* from nst_nasaka_db.swapp_table_info t where ".$cond." order by div,sequencenumber,columid";
			    $result = oci_parse($this->connection, $query);
                $r = oci_execute($result);
			    return $result;
		    }
		    else
		    {
		        $query = "select t.* from nst_nasaka_db.swapp_table_info t order by div,sequencenumber,columid";
			    $result = oci_parse($this->connection, $query);
                $r = oci_execute($result);
			    return $result;
		    }
	  }
    public function update()
    {
        $this->dataoperationmode = operationmode::Update;
        if ($this->entryvalidation() <> 0)
        {
            return 0;
            exit;
        }
        elseif ($this->datavalidation() <> 0)
        {
            return 0;
            exit;
        }
        $query = "
        update nst_nasaka_db.swapp_table_info set 
        data_type =".$this->invl($this->data_type,false)."
        ,iscompulsory = ".$this->invl($this->iscompulsory,true)."
        ,dependoncolumid = ".$this->invl($this->dependoncolumid,true,true)."
        ,entry_para_maxg_cal = ".$this->invl($this->entry_para_maxg_cal,true)."
        ,engdesc =".$this->invl($this->engdesc,false)."
        ,unicodedesc =".$this->invl($this->unicodedesc,false)."
        ,iscombo = ".$this->invl($this->iscombo,true)."
        ,combotableowner =".$this->invl($this->combotableowner,false)."
        ,combotable =".$this->invl($this->combotable,false)."
        ,comboengfield =".$this->invl($this->comboengfield,false)."
        ,combounicodefield =".$this->invl($this->combounicodefield,false)."
        ,combodatafield =".$this->invl($this->combodatafield,false)."
        ,combotablecondition =".$this->invl($this->combotablecondition,false)."
        ,isprimarykey = ".$this->invl($this->isprimarykey,true)."
        ,isadddisplay = ".$this->invl($this->isadddisplay,true)."
        ,isreadonly = ".$this->invl($this->isreadonly,true)."
        ,isfinddisplay = ".$this->invl($this->isfinddisplay,true)."
        ,isqueryinput = ".$this->invl($this->isqueryinput,true)."
        ,islistquery = ".$this->invl($this->islistquery,true)."
        ,div = ".$this->invl($this->div,true)."
        ,sequencenumber = ".$this->invl($this->sequencenumber,true)."
        where 
        owner =".$this->invl($this->owner,false)."
        and tablename =".$this->invl($this->tablename,false)."
        and columid =".$this->invl($this->columid,true)."
        and fieldname =".$this->invl($this->fieldname,false);
        $result = oci_parse($this->connection, $query);
        if (oci_execute($result,OCI_NO_AUTO_COMMIT))
        {
            return 1;
            exit;
        }
            else
        {
            return 0;
            exit;
        }
    }
    public function delete()
    {
        $this->dataoperationmode = operationmode::Delete;
        if ($this->entryvalidation() <> 0)
        {
            return 0;
            exit;
        }
        elseif ($this->datavalidation() <> 0)
        {
            return 0;
            exit;
        }
        $query = "
        delete from nst_nasaka_db.swapp_table_info
        where 
        owner =".$this->invl($this->owner,false)."
        and tablename =".$this->invl($this->tablename,false)."
        and columid =".$this->invl($this->columid,true)."
        and fieldname =".$this->invl($this->fieldname,false);
        $result = oci_parse($this->connection, $query);
        if (oci_execute($result,OCI_NO_AUTO_COMMIT))
        {
             return 1;
             exit;
        }
        else
        {
            return 0;
            exit;
        }
    }
    public function fetch()
    {
        $this->dataoperationmode = operationmode::Select;
        $query = "select 
        owner
        ,tablename
        ,columid
        ,fieldname
        ,data_type
        ,iscompulsory
        ,dependoncolumid
        ,entry_para_maxg_cal
        ,engdesc
        ,unicodedesc
        ,iscombo
        ,combotableowner
        ,combotable
        ,comboengfield
        ,combounicodefield
        ,combodatafield
        ,isprimarykey
        ,isadddisplay
        ,isreadonly
        ,isfinddisplay
        ,isqueryinput
        ,combotablecondition
        ,islistquery
        ,div
        ,sequencenumber
        from nst_nasaka_db.swapp_table_info where 
        owner =".$this->invl($this->owner,false)."
        and tablename =".$this->invl($this->tablename,false)."
        and columid =".$this->invl($this->columid,true)."
        and fieldname =".$this->invl($this->fieldname,false).
        " order by div,sequencenumber,columid";
        $result = oci_parse($this->connection, $query);
        $r = oci_execute($result);
        if ($row = oci_fetch_array($result,OCI_ASSOC+OCI_RETURN_NULLS))
        {
                $this->owner = $row['OWNER'];
                $this->tablename = $row['TABLENAME'];
                $this->columid = $row['COLUMID'];
                $this->fieldname = $row['FIELDNAME'];
                $this->data_type = $row['DATA_TYPE'];
                $this->iscompulsory = $row['ISCOMPULSORY'];
                $this->dependoncolumid = $row['DEPENDONCOLUMID'];
                $this->entry_para_maxg_cal = $row['ENTRY_PARA_MAXG_CAL'];
                $this->engdesc = $row['ENGDESC'];
                $this->unicodedesc = $row['UNICODEDESC'];
                $this->iscombo = $row['ISCOMBO'];
                $this->combotableowner = $row['COMBOTABLEOWNER'];
                $this->combotable = $row['COMBOTABLE'];
                $this->comboengfield = $row['COMBOENGFIELD'];
                $this->combounicodefield = $row['COMBOUNICODEFIELD'];
                $this->combodatafield = $row['COMBODATAFIELD'];
                $this->isprimarykey = $row['ISPRIMARYKEY'];
                $this->isadddisplay = $row['ISADDDISPLAY'];
                $this->isreadonly = $row['ISREADONLY'];
                $this->isfinddisplay = $row['ISFINDDISPLAY'];
                $this->isqueryinput = $row['ISQUERYINPUT'];
                $this->combotablecondition = $row['COMBOTABLECONDITION'];
                $this->islistquery = $row['ISLISTQUERY'];
                $this->div = $row['DIV'];
                $this->sequencenumber = $row['SEQUENCENUMBER'];
                $this->found=true;
                return true;
        }
        else
        {
        return false;
        }
    }
    Public function table_info_add()
    {
        $owner=$this->owner;
        $tablename=$this->tablename;
        $sql = 'BEGIN nst_nasaka_db.swapp_table_info_proc(:powner,:ptable); END;';
        $result = oci_parse($this->connection,$sql);
        oci_bind_by_name($result,':powner',$owner,30);
        oci_bind_by_name($result,':ptable',$tablename,30);
        $ret=oci_execute($result);
        if ($ret==true)
        {
            return 1;
        }
        else
        {
            return 0;
        }
    }
    Public function table_info_generate()
    {
        $owner=$this->owner;
        $tablename=$this->tablename;
        $sql = 'BEGIN nst_nasaka_db.swapp_form_generate(:powner,:ptable); END;';
        $result = oci_parse($this->connection,$sql);
        oci_bind_by_name($result,':powner',$owner,30);
        oci_bind_by_name($result,':ptable',$tablename,30);
        $ret=oci_execute($result);
        if ($ret==true)
        {
            return 1;
        }
        else
        {
            return 0;
        }
    }
}
?>

