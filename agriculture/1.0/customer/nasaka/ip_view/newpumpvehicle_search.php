<?php
    //This is generated by Swapp Software Application on 07/05/2019 05:06:02 PM for PHP
    require_once("../info/phpsqlajax_dbinfo.php");
    require_once("../info/phpgetloginview.php");
    require_once("../info/routine.php");
    require_once("../ip_model/harvestervehiclepair_db_oracle.php");
    $connection =swapp_connection();
    $searchTerm = $_GET['term'];
    $pumpcode = $_GET['pumpcode'];
    $transactiondate = $_GET['transactiondate'];
    if ($searchTerm=='')
    {
        $searchTerm = 'No Values';
    }
    $seasoncode = $_SESSION['yearperiodcode'];
    if (preg_match('/^[0-9]*$/', $searchTerm))
    {
    }
      
   if ($searchTerm == '**')
   {
       $query = "select t.contractorcode
       ,(t.vehiclenumber||'- Name-'||t.contractornameeng)narr
       from othercontractor t
       order by t.contractorcode"       ;
   }
   else
   {
       $query = "select t.contractorcode
       ,(t.vehiclenumber||'- Name-'||t.contractornameeng)narr
       from othercontractor t      
       where   (upper(t.vehiclenumber) like upper('%".$searchTerm."%'))
       order by t.contractorcode
       ";
   }
   
   $result = oci_parse($connection, $query); $r = oci_execute($result);
   $cnt=0;
   while ($row = oci_fetch_array($result,OCI_ASSOC+OCI_RETURN_NULLS))
   {
    
    $id = $row['CONTRACTORCODE'];
    if ($_SESSION['lng'] == "English")
    {
        $name = $row['NARR'];
    }
    else
    {
        $name = $row['NARR'];
    }
    $data[] = array( 
        'id' => $id
        ,'label' => $name
        ,'value' => $name
        
        );
}
/* if ($cnt==0)
{
    $data[] = array( 
        'id' => ''
        ,'label' => ''
        ,'value' => ''
        ,'purchaserate' => ''
        ,'salerate' => ''
        );
} */
//return json data
echo json_encode($data);
?>