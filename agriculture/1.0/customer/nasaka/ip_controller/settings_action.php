<?php
    //This is generated by Swapp Software Application on 06/06/2019 12:46:27 PM for PHP
    require("../info/phpgetloginview.php");
    include("../info/ncryptdcrypt.php");
    require("../info/routine.php");
    $weightslipdate=$_POST["weightslipdate"];
    $shiftcode=$_POST["shiftcode"];
    $katacode=$_POST["katacode"];
  switch ($_POST['btn'])
  {
    case 'Change':
      if ($weightslipdate=='')
      {
          echo '<span style="background-color:#f44;color:#ff8;text-align:left;">Invalid Date</span></br>';
          echo '<button onclick="history.go(-1);">Back </button>';
          unset($_SESSION['weightslipdate']);
          unset($_SESSION['shiftcode']);
          unset($_SESSION['katacode']);
          break;          
      }
      if ($shiftcode=='' or $shiftcode<=0 or $shiftcode>=4)
      {
          echo '<span style="background-color:#f44;color:#ff8;text-align:left;">Invalid Shift</span></br>';
          echo '<button onclick="history.go(-1);">Back </button>';
          unset($_SESSION['weightslipdate']);
          unset($_SESSION['shiftcode']);
          unset($_SESSION['katacode']);
          break;          
      }
      if ($katacode=='' or $katacode<=0 or ($katacode!=1 and $katacode!=2 and $katacode!=3 and $katacode!=9))
      {
          echo '<span style="background-color:#f44;color:#ff8;text-align:left;">Invalid Kata</span></br>';
          echo '<button onclick="history.go(-1);">Back </button>';
          unset($_SESSION['weightslipdate']);
          unset($_SESSION['shiftcode']);
          unset($_SESSION['katacode']);
          break;          
      }
      $_SESSION['weightslipdate'] = $weightslipdate;
      $_SESSION['shiftcode'] = $shiftcode;
      $_SESSION['katacode'] = $katacode;
      
      if ($_POST['vehiclecategorycode']>0 and $_POST['weightcategorycode']>0)
      {
          if ($_POST['weightcategorycode']==1)
          {
            $flag_en = fnEncrypt('');
          }
          elseif ($_POST['weightcategorycode']==2)
          {
            $flag_en = fnEncrypt('Query');
          }
          elseif ($_POST['weightcategorycode']==3)
          {
            $flag_en = fnEncrypt('Query');
          }
          $vehiclecategorycode_en = fnEncrypt($_POST['vehiclecategorycode']);
          $weightcategorycode_en = fnEncrypt($_POST['weightcategorycode']);
          //header("Location: ../ip_view/weightslip.php?vehiclecategorycode=".$vehiclecategorycode_en."&weightcategorycode=".$weightcategorycode_en."&flag=".$flag_en);
          header("Location: ../mis/entitymenu.php");
      }
      else
      {
          echo '<span class="w3-container" style="background-color:#0a0;color:#ff8;text-align:left;">Settings Updated successfully</span></br>';  
          echo '<a href="../mis/entitymenu.php">Entity Menu</a></br>';
      }
    break;
		default:
			echo 'Communication Error';
      echo '<button onclick="history.go(-1);">Back </button>';
			break;
	}

